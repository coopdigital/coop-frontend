{"version":3,"sources":["../../../src/validation/summary/index.mjs"],"names":["ValidationSummary","containerId","heading","message","errorOnClick","errorClickHandler","container","document","getElementById","instance","addEventListener","hasAttribute","enable","id","setAttribute","removeAttribute","focus","reset","innerHTML","setError","error","appendChild","createHeading","createMessage","setErrors","errors","createErrors","element","createElement","classList","add","createError","messageHtml","item","href","fragment","createDocumentFragment","subheading","list","forEach"],"mappings":";;;;;;;;;AAAA;;AAEA;AACA;AACA;IACMA,iB;AACJ,6BAAYC,WAAZ,SAIQ;AAAA,kCAAJ,EAAI;AAAA,4BAHNC,OAGM;AAAA,QAHNA,OAGM,6BAHI,mBAGJ;AAAA,4BAFNC,OAEM;AAAA,QAFNA,OAEM,6BAFI,2BAEJ;AAAA,iCADNC,YACM;AAAA,QADNA,YACM,kCADSC,eACT;;AACN,SAAKH,OAAL,GAAeA,OAAf;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKG,SAAL,GAAiBC,QAAQ,CAACC,cAAT,CAAwBP,WAAxB,CAAjB,CAHM,CAKN;;AACA,QAAI,KAAKK,SAAL,CAAeG,QAAnB,EAA6B;AAC3B,aAAO,IAAP;AACD,KARK,CAUN;;;AACA,SAAKH,SAAL,CAAeI,gBAAf,CAAgC,OAAhC,EAAyCN,YAAzC,EAXM,CAaN;;AACA,QAAI,CAAC,KAAKE,SAAL,CAAeK,YAAf,CAA4B,QAA5B,CAAL,EAA4C;AAC1C,WAAKC,MAAL;AACD,KAhBK,CAkBN;;;AACA,SAAKN,SAAL,CAAeG,QAAf,GAA0B,IAA1B;AACD;AAED;AACF;AACA;;;;;SACEG,M,GAAA,kBAAS;AACP,QAAqBC,EAArB,GAA8B,IAA9B,CAAQP,SAAR,CAAqBO,EAArB;AAEA,SAAKP,SAAL,CAAeQ,YAAf,CAA4B,iBAA5B,EAAkDD,EAAlD;AACA,SAAKP,SAAL,CAAeS,eAAf,CAA+B,QAA/B;AACA,SAAKT,SAAL,CAAeU,KAAf;AACD;AAED;AACF;AACA;;;SACEC,K,GAAA,iBAAQ;AACN,SAAKX,SAAL,CAAeQ,YAAf,CAA4B,QAA5B,EAAsC,IAAtC;AACA,SAAKR,SAAL,CAAeS,eAAf,CAA+B,iBAA/B;AACA,SAAKT,SAAL,CAAeY,SAAf,GAA2B,EAA3B;AACD;AAED;AACF;AACA;;;SACEC,Q,GAAA,kBAASC,KAAT,EAAqB;AAAA,QAAZA,KAAY;AAAZA,MAAAA,KAAY,GAAJ,EAAI;AAAA;;AACnB,SAAKH,KAAL;AAEA,QAAQf,OAAR,GAAuC,IAAvC,CAAQA,OAAR;AAAA,QAA8BW,EAA9B,GAAuC,IAAvC,CAAiBP,SAAjB,CAA8BO,EAA9B;AAEA,SAAKP,SAAL,CAAee,WAAf,CAA2BrB,iBAAiB,CAACsB,aAAlB,CAAgC;AAAEpB,MAAAA,OAAO,EAAPA,OAAF;AAAWW,MAAAA,EAAE,EAAKA,EAAL;AAAb,KAAhC,CAA3B;AACA,SAAKP,SAAL,CAAee,WAAf,CAA2BrB,iBAAiB,CAACuB,aAAlB,CAAgC;AAAEpB,MAAAA,OAAO,EAAEiB;AAAX,KAAhC,CAA3B,EANmB,CAQnB;;AACA,SAAKR,MAAL;AACD;AAED;AACF;AACA;;;SACEY,S,GAAA,mBAAUC,MAAV,EAAuB;AAAA,QAAbA,MAAa;AAAbA,MAAAA,MAAa,GAAJ,EAAI;AAAA;;AACrB,SAAKR,KAAL;AAEA,QAAQf,OAAR,GAAgD,IAAhD,CAAQA,OAAR;AAAA,QAAiBC,OAAjB,GAAgD,IAAhD,CAAiBA,OAAjB;AAAA,QAAuCU,EAAvC,GAAgD,IAAhD,CAA0BP,SAA1B,CAAuCO,EAAvC;AAEA,SAAKP,SAAL,CAAee,WAAf,CAA2BrB,iBAAiB,CAACsB,aAAlB,CAAgC;AAAEpB,MAAAA,OAAO,EAAPA,OAAF;AAAWW,MAAAA,EAAE,EAAKA,EAAL;AAAb,KAAhC,CAA3B;AACA,SAAKP,SAAL,CAAee,WAAf,CAA2BrB,iBAAiB,CAAC0B,YAAlB,CAA+B;AAAED,MAAAA,MAAM,EAANA,MAAF;AAAUtB,MAAAA,OAAO,EAAPA;AAAV,KAA/B,CAA3B,EANqB,CAQrB;;AACA,SAAKS,MAAL;AACD;AAED;AACF;AACA;;;oBACSU,a,GAAP,8BAAsC;AAAA,QAAfpB,OAAe,SAAfA,OAAe;AAAA,QAANW,EAAM,SAANA,EAAM;AACpC,QAAMc,OAAO,GAAGpB,QAAQ,CAACqB,aAAT,CAAuB,IAAvB,CAAhB;AACAD,IAAAA,OAAO,CAACd,EAAR,GAAaA,EAAb;AACAc,IAAAA,OAAO,CAACT,SAAR,GAAoBhB,OAApB;AACA,WAAOyB,OAAP;AACD;AAED;AACF;AACA;;;oBACSJ,a,GAAP,8BAAkC;AAAA,QAAXpB,OAAW,SAAXA,OAAW;AAChC,QAAMwB,OAAO,GAAGpB,QAAQ,CAACqB,aAAT,CAAuB,GAAvB,CAAhB;AACAD,IAAAA,OAAO,CAACE,SAAR,CAAkBC,GAAlB,CAAsB,yBAAtB;AACAH,IAAAA,OAAO,CAACT,SAAR,GAAoBf,OAApB;AACA,WAAOwB,OAAP;AACD;AAED;AACF;AACA;;;oBACSI,W,GAAP,4BAAiD;AAAA,QAA5BlB,EAA4B,SAA5BA,EAA4B;AAAA,QAAxBV,OAAwB,SAAxBA,OAAwB;AAAA,QAAf6B,WAAe,SAAfA,WAAe;AAC/C,QAAMC,IAAI,GAAG1B,QAAQ,CAACqB,aAAT,CAAuB,IAAvB,CAAb,CAD+C,CAG/C;;AACA,QAAII,WAAJ,EAAiB;AACfC,MAAAA,IAAI,CAACf,SAAL,GAAiBc,WAAjB;AACD,KAFD,MAEO;AACL,UAAMZ,KAAK,GAAGb,QAAQ,CAACqB,aAAT,CAAuB,GAAvB,CAAd,CADK,CAGL;;AACAR,MAAAA,KAAK,CAACc,IAAN,SAAiBrB,EAAjB;AACAO,MAAAA,KAAK,CAACS,SAAN,CAAgBC,GAAhB,CAAoB,sBAApB;AACAV,MAAAA,KAAK,CAACF,SAAN,GAAkBf,OAAlB,CANK,CAQL;;AACA8B,MAAAA,IAAI,CAACZ,WAAL,CAAiBD,KAAjB;AACD;;AAED,WAAOa,IAAP;AACD;AAED;AACF;AACA;;;oBACSP,Y,GAAP,6BAAyC;AAAA,QAAnBvB,OAAmB,SAAnBA,OAAmB;AAAA,QAAVsB,MAAU,SAAVA,MAAU;AACvC,QAAMU,QAAQ,GAAG5B,QAAQ,CAAC6B,sBAAT,EAAjB;AACA,QAAMC,UAAU,GAAGrC,iBAAiB,CAACuB,aAAlB,CAAgC;AAAEpB,MAAAA,OAAO,EAAPA;AAAF,KAAhC,CAAnB;AACA,QAAMmC,IAAI,GAAG/B,QAAQ,CAACqB,aAAT,CAAuB,IAAvB,CAAb,CAHuC,CAKvC;;AACAU,IAAAA,IAAI,CAACT,SAAL,CAAeC,GAAf,CAAmB,sBAAnB,EANuC,CAQvC;;AACAL,IAAAA,MAAM,CAACc,OAAP,CAAe,UAACN,IAAD;AAAA,aAAUK,IAAI,CAC1BjB,WADsB,CACVrB,iBAAiB,CAAC+B,WAAlB,CAA8BE,IAA9B,CADU,CAAV;AAAA,KAAf,EATuC,CAYvC;;AACAE,IAAAA,QAAQ,CAACd,WAAT,CAAqBgB,UAArB;AACAF,IAAAA,QAAQ,CAACd,WAAT,CAAqBiB,IAArB;AAEA,WAAOH,QAAP;AACD,G;;;;;eAGYnC,iB","sourcesContent":["import { click as errorClickHandler } from './handlers.mjs';\n\n/**\n * Validation summary box\n */\nclass ValidationSummary {\n  constructor(containerId, {\n    heading = 'Thereâ€™s a problem',\n    message = 'Check the form. You must:',\n    errorOnClick = errorClickHandler,\n  } = {}) {\n    this.heading = heading;\n    this.message = message;\n    this.container = document.getElementById(containerId);\n\n    // Skip if already instantiated\n    if (this.container.instance) {\n      return this;\n    }\n\n    // Handle clicks on error links\n    this.container.addEventListener('click', errorOnClick);\n\n    // Auto-enable if already visible\n    if (!this.container.hasAttribute('hidden')) {\n      this.enable();\n    }\n\n    // Attach instance to container\n    this.container.instance = this;\n  }\n\n  /**\n   * Enable validation summary\n   */\n  enable() {\n    const { container: { id } } = this;\n\n    this.container.setAttribute('aria-labelledby', `${id}-heading`);\n    this.container.removeAttribute('hidden');\n    this.container.focus();\n  }\n\n  /**\n   * Reset validation summary\n   */\n  reset() {\n    this.container.setAttribute('hidden', true);\n    this.container.removeAttribute('aria-labelledby');\n    this.container.innerHTML = '';\n  }\n\n  /**\n   * Set single error message\n   */\n  setError(error = '') {\n    this.reset();\n\n    const { heading, container: { id } } = this;\n\n    this.container.appendChild(ValidationSummary.createHeading({ heading, id: `${id}-heading` }));\n    this.container.appendChild(ValidationSummary.createMessage({ message: error }));\n\n    // Enable container\n    this.enable();\n  }\n\n  /**\n   * Set multiple error messages\n   */\n  setErrors(errors = []) {\n    this.reset();\n\n    const { heading, message, container: { id } } = this;\n\n    this.container.appendChild(ValidationSummary.createHeading({ heading, id: `${id}-heading` }));\n    this.container.appendChild(ValidationSummary.createErrors({ errors, message }));\n\n    // Enable container\n    this.enable();\n  }\n\n  /**\n   * Build error heading\n   */\n  static createHeading({ heading, id }) {\n    const element = document.createElement('h2');\n    element.id = id;\n    element.innerHTML = heading;\n    return element;\n  }\n\n  /**\n   * Build message\n   */\n  static createMessage({ message }) {\n    const element = document.createElement('p');\n    element.classList.add('coop-c-message__message');\n    element.innerHTML = message;\n    return element;\n  }\n\n  /**\n   * Build error link item\n   */\n  static createError({ id, message, messageHtml }) {\n    const item = document.createElement('li');\n\n    // Custom HTML or plain link?\n    if (messageHtml) {\n      item.innerHTML = messageHtml;\n    } else {\n      const error = document.createElement('a');\n\n      // Customise link\n      error.href = `#${id}`;\n      error.classList.add('coop-c-message__link');\n      error.innerHTML = message;\n\n      // Add error to list item\n      item.appendChild(error);\n    }\n\n    return item;\n  }\n\n  /**\n   * Build error list or single message\n   */\n  static createErrors({ message, errors }) {\n    const fragment = document.createDocumentFragment();\n    const subheading = ValidationSummary.createMessage({ message });\n    const list = document.createElement('ul');\n\n    // Mark up list\n    list.classList.add('coop-c-message__list');\n\n    // Add each error\n    errors.forEach((item) => list\n      .appendChild(ValidationSummary.createError(item)));\n\n    // Add subheading, error list\n    fragment.appendChild(subheading);\n    fragment.appendChild(list);\n\n    return fragment;\n  }\n}\n\nexport default ValidationSummary;\n"],"file":"index.js"}